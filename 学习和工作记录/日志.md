# 2021年8月26日16:11:17

1. 这两天在完成文哥布置的项目练习-微信小程序实现同步画板。我先在Web端学习和实现。

   1. 熟悉<canvas>绘图，较简单，已经可以实现本地画板；

   2. 使用WebSocket实现网络通信。（计划：今天）

      遇到问题：node的WebSocket资料实在是太少了，加之我网络基础并不好，一直学不动。客户端（浏览器）有浏览器提供的ws对象，node需要使用库，了解到ws和socket.io，但ws是真的找不到资料，只看示例我看不懂。于是改成Socket.IO，至少有官方文档，是全英的，虽然词汇比较简单，但以我的英语基础只能慢慢啃。目前正在照着示例学习，希望加快进度，本周完成web端的应用构建，开始使用小程序实现。

   3. 构建Web端同步画板的应用。

   4. 在Nginx服务器上部署后端服务器。

   5. 迁移到小程序。

   6. 对项目进行优化。

# 2021年8月27日10:58:51

1. 昨天计划中的（2）于今天上午完成，定位和解决了静态文件服务的问题，详见<a href="../JavaScript/疑问收集和解答.md">JavaScript/疑问收集与解答/同步画板(Web端)</a>部分；熟悉了Socket.IO的实践处理机制，目前计划于今天内完成Web端同步画板，并部署到服务器。



# 2021年8月30日15:53:44

1. 上周五（8.27）完成了1-4，实现了Web版画板的基础功能，今天开始将其迁移到微信小程序。

   1. 小程序本地画板	（完成）
   2. 小程序WebSocket通信  （进行中）
   3. 小程序同步画板  （未开始）

   实现本地画板时，小程序的Canvas接口让我迷惑了很久，一整个上午到中午时间才基本实现。目前实现WebSocket通信，我不知道如何将之前Web端使用的Socket.IO应用到小程序后端（貌似互不兼容），也找不到示例，故准备小程序端使用小程序接口，服务器使用ws库。

# 2021年8月31日15:32:07

1. 昨天安排的任务基本完成，WebSocket后端采用ws库，前端使用小程序提供的接口。童文给的要求基本满足（差一个房间）。

   问题与解决：完成web版时，Socket.IO可以自定义事件，但做小程序时就不行了，于是将不同的触摸事件的数据写成JSON类发出到后端，通过指定的属性值分辨事件来源。

2. 想要实现房间功能。看了ws的`clients`的接口文档，也打印出client的数据，没能明白如何识别不同客户端。

   网上找到的都是Socket.IO的实现，没有别的示例。我也没有去看ws的源码或探究原生WebSocket实现的难度。暂时放一放，画板的实现先到此为止了。

3. 后续安排

   1. 检验小程序能否在局域网（同一网段）中实现WebSocket通信；

      小程序指南要求仅通过已备案的域名进行网络通信。

   2. 实现小程序搜索局域网（同一网段）内IP地址；

   3. 实现遥控器核心功能。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 

# 2021年9月1日16:04:47

1. 昨天临近下班找到一个小程序mDNS搜索示例 [middleHallo/mdns (github.com)](https://github.com/middleHallo/mdns)，并在BenQ-Mobile的网络中搜索到mDNS服务，回去之后尝试在Windows和安卓建立mDNS服务，没成。

   今天上班找童文，他查看相关文档后写了个开启mDNS服务的安卓app，我在小程序端搜索到了这个服务，证明了搜索局域网内安卓设备的可行性。

2. 上午从刘丁处获得了遥控器小程序的原型，由于后面一直在帮小美看Java的事情，到现在也没有看这个原型。负责遥控器的后端的是韦仁辉，接口文档的活被分给了我。

3. 安排：

   熟悉产品原型


# 2021年9月2日10:49:59

1. 这个遥控器小程序远远超过了遥控器本身的复杂度。

   - 遥控器基础功能
   - 主题切换
   - 同步画板
   - 触控板
   - ……

2. 一些问题的设想方案

   1. 主题切换

      在“智能1”和“智能2”间切换，修改元素类名即可；

      在“智能”和“极简”间切换，需要修改贴图路径，将`<image>`的`src`绑定到路径变量，通过js切换；

   2. 主页的主题选择

      使用动画和WXS响应事件（修改style而非data）

# 2021年9月3日14:51:17

1. 解决方案

   1. 主题

      因为三种样式重复的东西太多，分成三个页面虽降低复杂度，但增加了过多的冗余，应尽量复用。

      从主页点击图片均传递参数`current`并进入`controlPage`页面，通过判断语句控制不同样式的显示。

   2. 功能按钮

      按钮重复度就更大了，所以单独做一个按钮组件。

      将更多地重复的工作交给组件，只需要把“按钮功能”和“遥控器样式（三种样式之一）”传递给组件即可。



# 2021年9月7日08:36:22

1. 昨天（周一）算是写了一天的CSS，因为涉及到三套主题，所以CSS写起来特别繁杂，这个时候我才想起预处理器，这个项目写完之后，后续项目可能就要开始使用less了。

2. 完成情急和计划

   1. 按照上周五的方案（另外将导航方向键等重复部分也做成了组件），花了周五几个小时加上昨天一天的时间，基本完成了功能按钮的样式和排布。

   2. 后续安排

      继续完成遥控器样式；

      完成“更换样式”功能；

      完成“更多设置”菜单；

# 2021年9月13日13:23:19

1. 从上周四（9.8）开始进行网络功能的实现，跟韦仁辉讨论网络选型，我们两个对网络都不是很熟悉，尽管在今天我们讨论确定了使用WebSocket完成可靠连接（连接状态、画板等），UDP实现按键信号的网络通信，但一些细节问题仍没有最终确定，就且做且看。

2. **接口封装**

   上周五，童文要求我们对使用到的网络接口再做一层封装（尽管微信小程序给的接口已经挺好了，后端用的第三方库也很完备、清晰），我看了下感觉有点难度，所以封装的工作放到后续优化上去（**预计使用Promise进行封装，还要再搞清楚点**）。

3. 工作安排

   1. 小程序扫码连接（查找mDNS自动连的方案又被毙了）的前端实现；
   2. WebSocket连接初始化连接状态；
   3. UDP发送按键信号；

# 2021年9月13日18:08:54

1. 在前端实现的过程中还是遇到了蛮多的问题，核心问题：

   在其他页面如何监听数据变化？

   提到使用Object.defineProperty()方法，回去研究一下。

# 2021年9月14日17:19:22

1. 使用了Object.defineProperty()，解决问题的同时引入了很多新问题，对其掌握不够导致，回滚到之前的方案。

# 2021年9月16日17:50:43

1. 要求小程序从后台恢复可自动重连并回到之前的页面，被一个跳转问题搞了很久，今天发现是自己写的路径问题，/为根路径，不加的话认为是相对路径。

# 2021年9月18日16:11:06

1. 对辅导员一同讨论了Object.defineProperty()的相关问题，也解决了之前提到的问题。
