## œ后台运行

使用 `node xx.js`运行项目，使用`node xx.js &`将项目置于后台运行

## WebStorm一键部署

#### 在“工具-部署-配置”中配置相关项

连接：

1. 类型：远程文件传输类型，SFTP；
2. SSH配置：略
3. 根路径：用作远程文件服务和Web服务器配置的根目录，没有实际作用
4. Web服务器URL：就是用户要浏览网站时访问的URL

映射：

1. 本地路径：本地需部署目录的绝对路径，/xx/xx/dist/
2. 部署路径：即在服务器上部署的位置，相对于“连接”中配置的根路径的相对路径，如果根路径就是站点路径，那么这里直接"/"即可。
3. Web路径：Web服务运行的路径，相对于Web服务器URL的相对路径

#### 部署

​	右键在上面配置好的本地路径的目录（如vue项目中的dist目录），选择”部署-上传到“，本地目录下的文件将上传到”部署路径“中，完成部署。

## 生产/开发环境中的baseURL与跨域

这个应该是vue的内容，也写在这里。

为了解决跨域的问题，开发过程中在vue.config.js中配置devServer进行代理，然而部署到服务器上之后，这个代理失效了。直接将网站的主机和端口作为了baseURL。
看到webpack-dev-server的文档说其编译后不会写入到任何输出文件，不知道是不是这个原因。

按照这个，根据不同的环境配置了不同的baseURL，实现了在开发和生产环境中配置不同baseURL的功能。部署后也可访问正确的API。[20191119_VUE打包后代理失效的问题_未来可期-CSDN博客_vue打包后代理失效](https://blog.csdn.net/qq_34086980/article/details/103140758)

## Nginx即生产环境中 的跨域

Vue项目`npm run serve`时，由webpack在8080端口上提供本地服务器，配置devServer代理解决跨域的问题；当项目打包再通过Nginx部署到生产环境后，由Nginx代理80端口的请求，提供Web服务。但当站点进行跨域请求时（比如项目访问同一服务器下3000端口的后台服务），仍然会有跨域的问题。

问题解决：

假设网站站点`a`，服务器站点`b`

开始对跨域的理解并不充分，导致做了一些错误的尝试：

搜了一下教程，我将Nginx对`a`的反向代理配置文件做了修改，在其`server`字段中的`location`字段中添加了下面这些字段

```js
   #必须字段，表示允许跨域，值为允许的域名，可以为*
   add_header 'Access-Control-Allow-Origin' '*';
   #可选字段，表示是否允许发送cookie，值为布尔值
   add_header 'Access-Control-Allow-Credentials' 'true';
   #必须字段，表示跨域请求允许的http方法，可以为*
   add_header 'Access-Control-Allow-Methods' '*';
```

但问题并未解决。（这里实际上应该配置到`b`上，即是下面第一种解决思路）

#### 跨域以及解决思路

1. 跨域的概念和原因不多赘述

2. 解决跨域 两种思路

   1. 第一种是”允许跨域“，服务端提供CORS支持，这样前端就不需要额外做别的事情了

      服务端设置CORS，在响应头的添加相应字段。自己线上的项目最终就是使用koa2-cors插件在服务端设置了跨域；若后端使用Nginx作为反向代理时，通过后端Nginx配置允许跨域即可。

   2. 第二种是消灭跨域这个问题，我不跨域就行了

      在本地开发环境下，使用webpack配置代理（正向代理），相当于前端和服务端在同一个域里，这样就不存在跨域的问题了。但这个是本地的情况下，通过Nginx将静态网站部署到服务器上时，需要使用到Nginx配置跨域代理，这里与第一种说的Nginx配置不同，这里是配置前端的代理。假如前端代码的请求为"/"开头的接口，服务器为`b.com:3000`，那么在前端Nginx的server中加上location
      
      `location / { proxy_pass http://b.com:3000}`
      
      但我这样尝试了，Nginx直接把后端返回的内容当成了页面数据，猜测是与网站的代理冲突了，应该将静态的站点资源全放在"/"下，而代码中的后端接口统一加个前缀如"/api"，分别为"/"和"/api"配置代理即可。这样是最接近所谓“纯前端”的解决方式。
      
      
      
      个人更倾向于第一种。还有别的方式，比较少用，不做更多了解了。